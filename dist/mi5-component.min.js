!function n(s,i,o){function a(t,e){if(!i[t]){if(!s[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=i[t]={exports:{}},s[t][0].call(r.exports,function(e){return a(s[t][1][e]||e)},r,r.exports,n,s,i,o)}return i[t].exports}for(var l="function"==typeof require&&require,e=0;e<o.length;e++)a(o[e]);return a}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../../src/Api"),s=e("../../src/HtmlComponent/BoundComponent"),i=e("../../src/HtmlComponent/ComponentMap");e={Component:n.Component,BoundComponent:s.BoundComponent,ComponentMap:i.ComponentMap,getComponent:i.getComponent},window.mi5=window.mi5||{},window.mi5.component=Object.assign(window.mi5.component||{},e),window.mi5.using=function(e,t){if(!e||!t)throw new Error("NullArgument");window.eval.call(window,"(function (arg) { window."+t+" = arg; })")(e)}},{"../../src/Api":2,"../../src/HtmlComponent/BoundComponent":17,"../../src/HtmlComponent/ComponentMap":19}],2:[function(e,t,r){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(e("./Css/CssInlineRule")),n(e("./Css/CssRule")),n(e("./Css/CssRuleContract")),n(e("./Css/CssVariable")),n(e("./Css/GetCssRulesInElement")),n(e("./Html/CreateElement")),n(e("./Html/DeleteNodeContent")),n(e("./Html/ElementType")),n(e("./Html/EscapeHtml")),n(e("./Html/FindIndexInParent")),n(e("./Html/FormFieldValue")),n(e("./Html/ExtractNodeContent")),n(e("./Html/QuerySelectorNodeList")),n(e("./Html/ValidateUniqueDomIds")),n(e("./HtmlComponent/BoundComponent")),n(e("./HtmlComponent/Component")),n(e("./HtmlComponent/ComponentMap")),n(e("./HtmlComponent/Options/IExistingElementOptions")),n(e("./HtmlComponent/Options/IInnerHtmlOptions")),n(e("./HtmlComponent/Options/IExistingLookupOptions")),n(e("./HtmlComponent/Options/IOuterHtmlOptions")),n(e("./HtmlComponent/Options/IComponentBindingOptions")),n(e("./Observable/IObservable")),n(e("./Observable/ObservableAssign")),n(e("./Observable/ObservableBase")),n(e("./Observable/ObservableProperty")),n(e("./Observable/ObservableProxy")),n(e("./Observable/ObservableState")),n(e("./Router/PageRouter")),n(e("./Router/AdvancedPageRouter")),n(e("./System/Async/DynamicWebWorker")),n(e("./System/Async/DeferredPromise")),n(e("./System/Async/Delay")),n(e("./System/Async/RepeatablePromise")),n(e("./System/Collections/ArrayUtilities")),n(e("./System/Collections/OrderBy")),n(e("./System/EventHandler/ArrayChangedEventArgs")),n(e("./System/EventHandler/Delegate")),n(e("./System/EventHandler/EventHandler")),n(e("./System/EventHandler/PropertyChangedEventArgs")),n(e("./System/Types/Constructable")),n(e("./System/Types/KeywordArguments")),n(e("./System/Types/NoneType")),n(e("./System/Utility/Assert")),n(e("./System/Utility/CloneDeep")),n(e("./System/Utility/CloneObject")),n(e("./System/Utility/Elvis")),n(e("./System/Utility/IsInteger")),n(e("./System/Utility/IsPrimitive")),n(e("./System/Utility/GetUniqueId")),n(e("./System/Utility/ObjectFullAssign"))},{"./Css/CssInlineRule":3,"./Css/CssRule":4,"./Css/CssRuleContract":5,"./Css/CssVariable":6,"./Css/GetCssRulesInElement":7,"./Html/CreateElement":8,"./Html/DeleteNodeContent":9,"./Html/ElementType":10,"./Html/EscapeHtml":11,"./Html/ExtractNodeContent":12,"./Html/FindIndexInParent":13,"./Html/FormFieldValue":14,"./Html/QuerySelectorNodeList":15,"./Html/ValidateUniqueDomIds":16,"./HtmlComponent/BoundComponent":17,"./HtmlComponent/Component":18,"./HtmlComponent/ComponentMap":19,"./HtmlComponent/Options/IComponentBindingOptions":20,"./HtmlComponent/Options/IExistingElementOptions":21,"./HtmlComponent/Options/IExistingLookupOptions":22,"./HtmlComponent/Options/IInnerHtmlOptions":23,"./HtmlComponent/Options/IOuterHtmlOptions":24,"./Observable/IObservable":25,"./Observable/ObservableAssign":30,"./Observable/ObservableBase":31,"./Observable/ObservableProperty":32,"./Observable/ObservableProxy":33,"./Observable/ObservableState":34,"./Router/AdvancedPageRouter":35,"./Router/PageRouter":36,"./System/Async/DeferredPromise":37,"./System/Async/Delay":38,"./System/Async/DynamicWebWorker":39,"./System/Async/RepeatablePromise":40,"./System/Collections/ArrayUtilities":41,"./System/Collections/OrderBy":42,"./System/EventHandler/ArrayChangedEventArgs":43,"./System/EventHandler/Delegate":44,"./System/EventHandler/EventHandler":45,"./System/EventHandler/PropertyChangedEventArgs":46,"./System/Types/Constructable":47,"./System/Types/KeywordArguments":48,"./System/Types/NoneType":49,"./System/Utility/Assert":50,"./System/Utility/CloneDeep":51,"./System/Utility/CloneObject":52,"./System/Utility/Elvis":53,"./System/Utility/GetUniqueId":54,"./System/Utility/IsInteger":55,"./System/Utility/IsPrimitive":56,"./System/Utility/ObjectFullAssign":57}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});class n extends e("./CssRule").CssRule{constructor(e,t,r){super(r),Object.assign(this,t),this.selector$=e}}r.CssInlineRule=n},{"./CssRule":4}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("../Html/ElementType"),a=e("../Html/CreateElement"),l=e("../System/Types/Constructable"),n=e("../System/Utility/GetUniqueId"),p=e("./CssVariable");function m(e){const t=[];t.push(...Object.getOwnPropertyNames(e).filter(e=>"constructor"!==e));e=Object.getPrototypeOf(e);return e&&"Object"!==e.constructor.name&&t.push(...m(e)),t}r.CssRule=class{constructor(e){this.styleSheetParent$=document.head,this.styleSheetId$=n.getUniqueId(),this.extends$=[],this.nested$=[],this.revert$=!1,this._constructed$=!1,this._selectors$=[],e&&(this.styleSheetParent$=e)}render$(e){if(!this._constructed$){if(this._constructed$=!0,this.revert$&&(this.all="initial"),this._extendClass$(),this.nested$){Array.isArray(this.nested$)||(this.nested$=[this.nested$]);for(var[t,r]of this.nested$.entries())l.constructorTypeGuard(r)&&(this.nested$[t]=new r(this.styleSheetParent$))}this._buildSelectors$(e)}let n=this.styleSheetParent$.querySelector("#"+this.styleSheetId$);n&&this.styleSheetParent$.removeChild(n),n=this.styleSheetParent$.appendChild(a.createElement(o.elementType.HTMLStyleElement,{id:this.styleSheetId$}));e=n.sheet;if(this._buildRule$(e),this.nested$)for(const s of this.nested$){s.styleSheetParent$=this.styleSheetParent$;for(const i of this._selectors$)s.render$(i)}return this}remove$(){var e=this.styleSheetParent$.querySelector("#"+this.styleSheetId$);e&&this.styleSheetParent$.removeChild(e)}_extendClass$(){if(this.extends$){Array.isArray(this.extends$)||(this.extends$=[this.extends$]);for(const t of this.extends$){let e;e=l.constructorTypeGuard(t)?new t:t;for(const r of Array.from(new Set(m(e))))r.endsWith("$")||(this[r]=e[r])}}}_buildSelectors$(e){e=e||"",this.scopeElement$&&!this._fakeScopeClass$&&(this._fakeScopeClass$=this._fakeScopeClass$||"scope-"+n.getUniqueId(),this.scopeElement$.classList.add(this._fakeScopeClass$));for(var t of this.selector$.split(",").map(e=>e.trim()))if(t=(t||"").replace("&",""),this._fakeScopeClass$)if(t){const r=t.split(" ");r[0]=e+r[0]+"."+this._fakeScopeClass$,this._selectors$.push(r.join(" ").trim()),this._selectors$.push((e+"."+this._fakeScopeClass$+" "+t).trim())}else this._selectors$.push(e+"."+this._fakeScopeClass$);else t?this._selectors$.push(e+t):e?this._selectors$.push(e):this._selectors$.push("body")}_buildRule$(e){const t=[],r=[];for(const u of Array.from(new Set(m(this))))if(!u.endsWith("$")&&this[u]&&"function"!=typeof this[u]){var n,s=this[u];if("string"==typeof s)t.push(`${u}: ${s}`);else if(s instanceof p.CssVariable)r.push(s),t.push(`${u}: var(--${s.name})`);else for(const h of Object.getOwnPropertyNames(s))h.endsWith("$")||("string"==typeof(n=s[h])?t.push(`${u}-${h}: ${n}`):(r.push(n),t.push(`${u}-${h}: var(--${s.name})`)))}var i=this._selectors$.join(", "),o=t.join("; \n");o||console.warn(`No CSS properties defined for rule: ${this.constructor.name} on ${i}.`);let a=`${i} { \n${o}; \n}`;this.media$&&(a=`@media ${this.media$} { \n${a}\n}`),e.insertRule(a,0);let l=1;for(const d of r){var c=`${d.scope} { --${d.name}: ${d.value}; }`;e.insertRule(c,l),l++}}}},{"../Html/CreateElement":8,"../Html/ElementType":10,"../System/Types/Constructable":47,"../System/Utility/GetUniqueId":54,"./CssVariable":6}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.CssSimpleRule=class{constructor(e){e&&Object.assign(this,e)}}},{}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.CssVariable=class{constructor(e,t,r=":root"){this.scope=":root",this.name=e,this.value=t,this.scope=r}}},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getCssRulesInElement=function(e){const t=[];for(const r of e.querySelectorAll("style"))for(const n of r.sheet.cssRules)t.push(n.cssText.replace(/\{/g,"\n    {\n   ").replace(/;/g,";\n    "));return t.join("\n")}},{}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const i=e("../System/Types/KeywordArguments"),o=e("./ElementType"),n=e("./ExtractNodeContent");function a(e,t={},r){return{tagName:e,properties:t={},attributes:r}=i.Kwarg.parseArgs({tagName:e,properties:t,attributes:r}),t&&"attributes"in t&&(r=Object.assign(r||{},t.attributes),delete t.attributes),function(e,t={},r){const n=document.createElement(e);if(r)for(const s of Object.getOwnPropertyNames(r))n.setAttribute(s,r[s]);return Object.assign(n,t),n}(e,t,r)}function s(e="",t={},r){return{htmlOrProperties:e="",propertiesOrAttributes:t={},attributes:r}=i.Kwarg.parseArgs({htmlOrProperties:e,propertiesOrAttributes:t,attributes:r}),c(o.elementType.HTMLDivElement,e,t,r)}function l(e="",t={},r){return{htmlOrProperties:e="",propertiesOrAttributes:t={},attributes:r}=i.Kwarg.parseArgs({htmlOrProperties:e,propertiesOrAttributes:t,attributes:r}),c(o.elementType.HTMLSpanElement,e,t,r)}function c(e,t="",r={},n){return t instanceof HTMLElement?function(e,t,r,n){const s=a(e,r,n);return s.appendChild(t),s}(e,t,r,n):"object"==typeof t?(s=e,o=r,(i=(i=t)||{}).innerHTML=i.innerHTML||"",a(s,i,o)):(e=e,t=String(t||""),n=n,(r=(r=r)||{}).innerHTML=t,a(e,r,n));var s,i,o}r.createElement=a,r.createHtml=function(e,t=!1){let r;return r=(t?l:s)((e||"").trim()),1!==r.childNodes.length?r:r.firstElementChild||(t?r:l(r.innerHTML))},r.createFragment=function(e){return e=s((e||"").trim()),n.extractNodeContent(e)},r.div=s,r.span=l,r.paragraph=function(e="",t={},r){return{htmlOrProperties:e="",propertiesOrAttributes:t={},attributes:r}=i.Kwarg.parseArgs({htmlOrProperties:e,propertiesOrAttributes:t,attributes:r}),c(o.elementType.HTMLParagraphElement,e,t,r)},r.anchor=function(e="",t={},r={},n){({htmlOrProperties:e="",hrefOrProperties:t={},propertiesOrAttributes:r={},attributes:n}=i.Kwarg.parseArgs({htmlOrProperties:e,hrefOrProperties:t,propertiesOrAttributes:r,attributes:n}));const s=c(o.elementType.HTMLAnchorElement,e,r,n);return"string"==typeof t&&(s.href=String(t||"")),s},r.button=function(e="",t={},r){return{htmlOrProperties:e="",propertiesOrAttributes:t={},attributes:r}=i.Kwarg.parseArgs({htmlOrProperties:e,propertiesOrAttributes:t,attributes:r}),c(o.elementType.HTMLButtonElement,e,t,r)}},{"../System/Types/KeywordArguments":48,"./ElementType":10,"./ExtractNodeContent":12}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deleteNodeContent=function(e){const t=document.createRange();t.selectNodeContents(e),t.deleteContents()}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),(r=r.elementType||(r.elementType={})).HTMLAnchorElement="a",r.HTMLAreaElement="area",r.HTMLAudioElement="audio",r.HTMLBRElement="br",r.HTMLBaseFontElement="basefont",r.HTMLBlockQuoteElement="blockquote",r.HTMLButtonElement="button",r.HTMLCanvasElement="canvas",r.HTMLDataElement="data",r.HTMLDataListElement="datalist",r.HTMLDialogElement="dialog",r.HTMLDivElement="div",r.HTMLDListElement="dl",r.HTMLEmbedElement="embed",r.HTMLFieldSetElement="fieldset",r.HTMLFormElement="form",r.HTMLHeading1Element="h1",r.HTMLHeading2Element="h2",r.HTMLHeading3Element="h3",r.HTMLHeading4Element="h4",r.HTMLHeading5Element="h5",r.HTMLHeading6Element="h6",r.HTMLHRElement="hr",r.HTMLImageElement="image",r.HTMLInputElement="input",r.HTMLLabelElement="label",r.HTMLLegendElement="legend",r.HTMLLIElement="li",r.HTMLLinkElement="link",r.HTMLMapElement="map",r.HTMLMeterElement="meter",r.HTMLModDelElement="del",r.HTMLModInsElement="ins",r.HTMLOListElement="ol",r.HTMLObjectElement="object",r.HTMLOptGroupElement="optgroup",r.HTMLOptionElement="option",r.HTMLOutputElement="output",r.HTMLParagraphElement="p",r.HTMLParamElement="param",r.HTMLPictureElement="picture",r.HTMLPreElement="pre",r.HTMLProgressElement="progress",r.HTMLQuoteElement="q",r.HTMLScriptElement="script",r.HTMLSelectElement="select",r.HTMLSourceElement="source",r.HTMLSpanElement="span",r.HTMLStyleElement="style",r.HTMLTableCaptionElement="caption",r.HTMLTableDataCellElement="td",r.HTMLTableHeaderCellElement="th",r.HTMLTableColElement="col",r.HTMLTableColGroupElement="colgroup",r.HTMLTableElement="table",r.HTMLTableRowElement="tr",r.HTMLTableSectionBodyElement="tbody",r.HTMLTableSectionFooterElement="tfoot",r.HTMLTableSectionHeaderElement="thead",r.HTMLTemplateElement="template",r.HTMLTextAreaElement="textarea",r.HTMLTimeElement="time",r.HTMLTrackElement="track",r.HTMLUListElement="ul",r.HTMLVideoElement="video"},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.escapeHtml=function(e){if(!e)return e;const t={"<":"&lt;",">":"&gt;","&":"&amp;","/":"&#x2F;","=":"&#x3D;",'"':"&quot;","'":"&#39;","`":"&#x60;"};return e.replace(/[&<>"'`=\/]/g,e=>t[e])}},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.extractNodeContent=function(e){const t=document.createRange();return t.selectNodeContents(e),t.extractContents()}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.findIndexInParent=function(e){var t=e.parentElement;if(t)return Array.from(t.children).indexOf(e)}},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const h=e("../System/Types/NoneType");function n(e){return!!e.checked}function s(e){if(e.value)return Number(e.value)}function i(e){return e.name?(document.querySelector(`input[name="${e.name}"]:checked`)||{}).value:e.checked?e.value:void 0}function o(e){return e.multiple?a(e):e.value}function a(e){return Array.from(e.selectedOptions).filter(e=>e.value).map(e=>e.value)}r.getFormFieldValue=function(e){if("input"!==e.tagName.toLowerCase())return"select"===e.tagName.toLowerCase()?o(e):"textarea"===e.tagName.toLowerCase()?e.value:void 0;{const t=e;return"checkbox"===t.type.toLowerCase()?n(t):"number"===t.type.toLowerCase()?s(t):"radio"===t.type.toLowerCase()?i(t):t.value}},r.getCheckboxValue=n,r.getNumberInputValue=s,r.getRadioValue=i,r.getSelectValue=o,r.getMultiSelectValue=a,r.getSimpleFormValue=function(e){if("select"===e.tagName.toLowerCase()&&e.multiple)throw new Error("Not valid for multi-selects");return e.value},r.setFormFieldValue=function(r,e){const t=(e=h.isNone(e)?"":e).toString();if("input"===r.tagName.toLowerCase()){const o=r;var n=o.type.toLowerCase();if("checkbox"===n)o.checked=!0===e||"true"===t.toLowerCase();else if("radio"===n)o.checked=t===o.value;else if("date"===n)e&&(o.value=i(new Date(t)));else if("datetime"===n||"datetime-local"===n){if(e){const a=new Date(t);isNaN(a.valueOf())||(o.value=`${i(a)}T${function(e){if(!isNaN(e.valueOf()))return"";var t=("0"+e.getHours()).slice(-2),e=("0"+e.getMinutes()).slice(-2);return`${t}:${e}`}(a)}`)}}else o.value=t}else if("select"===r.tagName.toLowerCase()){const l=r,c=Array.from(l.options);if(l.multiple){if(!Array.isArray(e))return s(c,e),void(l.value=t);e.map(e=>{s(c,e)});for(const u of c)u.selected=-1<e.map(e=>e.toString()).indexOf(u.value)}else s(c,e),l.value=t}else"textarea"===r.tagName.toLowerCase()?r.value=t:console.warn(`Called setFormFieldValue on non-form field ${r.tagName} ${r.id||""}`);function s(e,t){-1<e.map(e=>e.value).indexOf(t.toString())||console.warn(`Called setFormFieldValue with nonexistent option ${t.toString()} on select ${r.id}`)}function i(e){if(!isNaN(e.valueOf()))return"";var t=("0"+(e.getUTCMonth()+1).toString()).slice(-2),r=("0"+e.getUTCDate().toString()).slice(-2);return`${e.getUTCFullYear()}-${t}-${r}`}}},{"../System/Types/NoneType":49}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.nodeListSelector=function(e,t){for(const n of e)if("matches"in n){if(n.matches(t))return n;var r=n.querySelector(t);if(r)return r}},r.nodeListSelectorAll=function(e,t){const r=[];for(const s of e){var n;"matches"in s&&(s.matches(t)&&r.push(s),n=s.querySelectorAll(t),r.push(...Array.from(n)))}return r}},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.validateUniqueDomIds=function(){const e=new Set;let t=0;for(const r of document.querySelectorAll("*[id]"))if(e.add(r.id),t++,e.size!==t)throw new Error(`Duplicate DOM IDs found. The first duplicate id is ${r}.`)}},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("../Html/CreateElement"),a=e("../Html/ElementType"),n=e("../Html/EscapeHtml"),l=e("../Html/ExtractNodeContent"),i=e("../Html/FormFieldValue"),s=e("../Html/QuerySelectorNodeList"),c=e("../Observable/IObservable"),u=e("../Observable/ObservableProperty"),h=e("../Observable/ObservableState"),d=e("../System/Types/Constructable"),p=e("../System/Types/NoneType");var m=e("./Component");const f=e("./ComponentMap"),y=e("../System/Types/KeywordArguments");class BoundComponent extends m.Component{constructor(e,t){super(t),this._attributeBindings=[],this._writeTargets=[],this._cssClassSwitches=[],this._replacements=[],this._async=!1,this._defer=!1,this._initialized=!1,this.viewModel=e;try{window.customElements.get("i-v")||window.customElements.define("i-v",g)}catch(e){}t=t||{};if(this._async=t.async||!1,this._defer=t.defer||!1,this._name=t.name,t.loopItemClass){if(!d.constructorTypeGuard(t.loopItemClass))throw new Error("loopItemClass is not a constructor");if(!(t.loopItemClass instanceof BoundComponent.constructor))throw new Error("loopItemClass is not an bound component")}if(this._loopItemClass=t.loopItemClass||BoundComponent,this._configureComponentBindings(),this.setTemplate(this.content.innerHTML),t.observeAllViewModel?this.observeAll():t.observeViewModel&&this.observe(),t.observeTargets)for(const r of t.observeTargets)this.observe(r);if(t.observeAllTargets)for(const n of t.observeAllTargets)this.observeAll(n);this._async?setTimeout(()=>this.render(),0):this.render(),this._initialized=!0}static inject(e="[ichigo]",t,r,n){({selector:e="[ichigo]",options:t,constructor:r,viewModel:n}=y.Kwarg.parseArgs({selector:e,options:t,constructor:r,viewModel:n}));const s=r||this,i=this._getOptions(t||{});return this._inject(e,i,e=>this._replaceElementWithBoundComponent(e,n,i,s),e=>this._convertElementToBoundComponent(e,n,i,s))}static injectBind(e,t="[ichigo]",r,n){return{selector:t="[ichigo]",options:r,constructor:n,viewModel:e}=y.Kwarg.parseArgs({selector:t,options:r,constructor:n,viewModel:e}),this.inject(t,r,n,e)}static _replaceElementWithBoundComponent(e,t,r,n){r=new n(t,this._mergePropertiesAndAttributes(e,r));return this._replaceElement(e,r),r}static _convertElementToBoundComponent(e,t,r,n){return new n(t,Object.assign({element:e},r))}write(e){if(this._writeTargets.length){e=e.currentTarget;if(e){const n=i.getFormFieldValue(e);if(void 0!==n)for(const r of this._writeTargets)if(r.startsWith("this."))t(this[r],()=>this[r]=n,this);else if("."===r)h.observableStateCheck(this.viewModel)?this.viewModel.value=n:t(this.viewModel,()=>this.viewModel=n,this.viewModel);else if("object"==typeof this.viewModel)if(h.observableStateCheck(this.viewModel)){const s=this.viewModel.value;t(s[r],()=>s[r]=n,s),this.viewModel.value=s}else t(this.viewModel[r],()=>this.viewModel[r]=n,this.viewModel);function t(e,t,r){"function"!=typeof e?u.observablePropertyCheck(e)?e.value=n:t():e.call(r,n)}}}}observe(e){return e=e||this.viewModel,c.observableCheck(e)&&e.subscribe(this.render,this),this}observeAll(e){if(!(e=e||this.viewModel))return this;this.observe(e);for(const t of Object.getOwnPropertyNames(e))this.observe(e[t]);return this}render(){if(this._defer&&!this._initialized)return this;for(const i of this._attributeBindings)if(i.bool){let e=this._getUntypedValue(i.source);e=i.negative?!e:!!e,e?this.content.setAttribute(i.attribute,e):this.content.removeAttribute(i.attribute)}else this.content.setAttribute(i.attribute,this._getStringValue(i.source)||"");this._valueAttribute&&(this.value=this._getUntypedValue(this._valueAttribute)),this._cssClasses&&(this.content.className=this._getStringValue(this._cssClasses)||"");for(const o of this._cssClassSwitches){let e=!!this._getUntypedValue(o.source);o.negative&&(e=!e),e?this.content.classList.add(o.class):this.content.classList.remove(o.class)}var e;if(this._cssStyle&&(e=this._getStringValue(this._cssStyle)||"",(this.content.style.cssText=e)&&!this.content.style.cssText&&console.warn(`Invalid style text in component: ${e}`)),this._loop){var t=this._getUntypedValue(this._loop.source);if(t&&"function"==typeof t[Symbol.iterator]){var r=l.extractNodeContent(this.content);for(const a of t){var n=document.importNode(this._loop.fragment,!0),s=Array.from(n.childNodes).slice();this.content.appendChild(n),this._loop.postProcess&&this.loopPostProcess(a,s,t,r)}}}if(this._cssDisplay){let e=this._getUntypedValue(this._cssDisplay.source);this._cssDisplay.negative&&(e=!e),e?this.content.style.setProperty("display",this._previousCssDisplaySetting||""):("none"!==this.content.style.display&&(this._previousCssDisplaySetting=this.content.style.display||void 0),this.content.style.setProperty("display","none"))}return this._updateHtmlReplacements(),this}setTemplate(e,t=!1){if(!e)return this;if(t&&!this._initialized)throw new Error("Update should not be true when called internally.");const r=o.createElement(a.elementType.HTMLTemplateElement);r.innerHTML=e;const n=document.importNode(r.content,!0);this._replacements.length=0;for(const i of n.querySelectorAll("i-v")){var s;this._name&&i.getAttribute("component")!==this._name||i.getAttribute("component")&&i.getAttribute("component")!==this._name||(s=i.hasAttribute("noescape")&&"false"!==i.getAttribute("noescape"),this._replacements.push({element:i,source:i.innerHTML,noescape:s}))}return this._initialized||this._defer||(this._defer=this._defer||!!this._replacements.find(e=>e.source.startsWith("this."))),this._defer&&!this._initialized||this._updateHtmlReplacements(),this._replacements.length&&(this.content.innerHTML="",this.content.appendChild(n)),t&&this.render(),this}setHtmlTemplate(e=".",t=!1){return this.setTemplate("<i-v noescape>"+e+"</i-v>",t)}setTextTemplate(e=".",t=!1){return this.setTemplate("<i-v>"+e+"</i-v>",t)}setLoop(e=".",t,r=!1,n=!1){if(!e||!t)throw new Error("Invalid arguments");return"string"==typeof t&&(t=o.createFragment(t)),this._loop={source:e,postProcess:!r,fragment:t},n&&this.render(),this}removeLoop(e=!1){return this._loop=void 0,e&&this.render(),this}setValueAttribute(e=".",t=!1){return this._valueAttribute=e,t&&this.render(),this}setVisibility(e=".",t=!1,r=!1){return this._cssDisplay=e?{source:e,negative:t}:void 0,r&&this.render(),this}addAttributeMapping(t,e=".",r=!1){if(!e||!t)throw new Error("Invalid arguments");return this._attributeBindings.find(e=>e.attribute===t)||this._attributeBindings.push({attribute:t,source:e,bool:!1,negative:!1}),r&&this.render(),this}addBooleanAttributeMapping(t,e=".",r=!1,n=!1){if(!e||!t)throw new Error("Invalid arguments");return this._attributeBindings.find(e=>e.attribute===t)||this._attributeBindings.push({attribute:t,source:e,bool:!0,negative:r}),n&&this.render(),this}removeAttributeMapping(t,e=!1){if(!t)throw new Error("Invalid argument");var r=this._attributeBindings.filter(e=>e.attribute!==t);return this._attributeBindings.length=0,this._attributeBindings.push(...r),e&&this.render(),this}setCssClass(e=".",t=!1){return this._cssClasses=e,t&&this.render(),this}setCssStyle(e=".",t=!1){return this._cssStyle=e,t&&this.render(),this}addCssClassSwitch(t,e=".",r=!1,n=!1){if(!t||!e)throw new Error("Invalid arguments");return this._cssClassSwitches.find(e=>e.class===t)||this._cssClassSwitches.push({class:t,source:e,negative:r}),n&&this.render(),this}removeCssClassSwitch(t,e=!1){if(!t)throw new Error("Invalid argument");var r=this._cssClassSwitches.filter(e=>e.class!==t);return this._cssClassSwitches.length=0,this._cssClassSwitches.push(...r),e&&this.render(),this}addWriteEvent(){return this.content.addEventListener("input",this.write.bind(this)),this}addWriteTarget(t=".",e=!1){if(!t)throw new Error("Invalid argument");return this._writeTargets.find(e=>e===t)||this._writeTargets.push(t),e&&this.render(),this}removeWriteTarget(t,e=!1){if(!t)throw new Error("Invalid argument");var r=this._writeTargets.filter(e=>e!==t);return this._writeTargets.length=0,this._writeTargets.push(...r),e&&this.render(),this}autoInject(e){if(e)BoundComponent.injectBind(this.viewModel,e,{parent:this.content});else for(const t of this.content.querySelectorAll("*"))for(const r of Array.from(t.attributes))if(r.name.startsWith("i5_")||r.name.startsWith(":")||r.name.startsWith("data-i5_")){BoundComponent.injectBind(this.viewModel,t);break}return this}dispose(){f.ComponentMap.components&&f.ComponentMap.components.delete(this.content)}loopPostProcess(e,t,r,n){this._loopItemClass.injectBind(e,s.nodeListSelectorAll(t,"[i5_item], [\\00003Aitem], [data-i5_item]"),{replace:!1,loopParent:this,async:this._async})}_getStringValue(e,t=!1){const r=this._getUntypedValue(e);return p.isNone(r)?r:"string"==typeof r?t?r:n.escapeHtml(r):t?r.toString():n.escapeHtml(r.toString())}_getUntypedValue(t){let r;if(t){let e=this.viewModel;if(h.observableStateCheck(e)&&(e=e.value),t.startsWith("this.")){if(e=this,!((t=t.slice(5))in this))return void console.warn(`this.${t} does not exist on view.`);r=this[t]}else if("."===t)r=e;else if("object"==typeof e){if(!(t in e))return console.warn(`this.${t} does not exist on viewModel.`),{};r=e[t]}return"function"==typeof r?r.call(e):u.observablePropertyCheck(r)?r.value:r}}_updateHtmlReplacements(){for(const t of this._replacements){var e=this._getStringValue(t.source,t.noescape)||"";const r=t.element;e!==r.innerHTML&&(r.innerHTML=e)}}_configureComponentBindings(){const e=Array.from(this.content.attributes).filter(e=>e.value||"i5_input"===e.name||":input"===e.name).map(e=>({name:e.name,value:e.value||""}));for(const i of Object.getOwnPropertyNames(this.content.dataset)){var t=this.content.dataset[i];!t&&"i5_input"!==i||e.push({name:i,value:t||""})}let r=!1;for(const o of e){var n=this._parseAttributeName(o.name);let e=!1;if(n)switch(n.type){case"name":this._name=this._name||o.value;break;case"boolNegative":e=!0;case"bool":if(!n.detail)throw new Error("Programming error");this.addBooleanAttributeMapping(n.detail,o.value,e),s.call(this);break;case"attr":if(!n.detail)throw new Error("Programming error");this.addAttributeMapping(n.detail,o.value),s.call(this);break;case"switchClassNegative":e=!0;case"switchClass":if(!n.detail)throw new Error("Programming error");this.addCssClassSwitch(n.detail,o.value,e),s.call(this);break;case"text":if(r)throw new Error("Can't set i5_text and i5_html at same time");r=!0,this.content.innerHTML=`<i-v>${o.value}</i-v>`,s.call(this);break;case"html":if(r)throw new Error("Can't set i5_text and i5_html at same time");r=!0,this.content.innerHTML=`<i-v noescape>${o.value}</i-v>`,s.call(this);break;case"value":this.setValueAttribute(o.value),s.call(this);break;case"ifNegative":e=!0;case"if":this.setVisibility(o.value,e),s.call(this);break;case"style":this.setCssStyle(o.value),s.call(this);break;case"class":this.setCssClass(o.value),s.call(this);break;case"input":if(this.addWriteEvent(),!o.value)break;n.detail&&this.setValueAttribute(o.value);case"target":this.addWriteTarget(o.value),s.call(this);break;case"loop":this.setLoop(o.value,l.extractNodeContent(this.content),"null"===n.detail),s.call(this);break;case"item":break;default:throw new Error("Not Implemented Ichigo attribute: "+n.type)}function s(){this._defer=this._defer||o.value.startsWith("this.")}}}_parseAttributeName(t){if(t.startsWith(":"))t="i5_"+t.slice(1);else{if("i5_item"===t)return;if("i5_event"===t)return;if(!t.startsWith("i5_"))return}if(t.startsWith("i5_attr")){if(":"!==t[7]&&"_"!==t[7])throw new Error("Invalid attribute binding syntax");if(t.length<9)throw new Error("Binding attribute name is missing.");return{type:"attr",detail:t.slice(8)}}if(t.startsWith("i5_bool")){let e=!1;if(":"!==t[7]&&"_"!==t[7]&&"-"!==t[7]&&"0"!==t[7])throw new Error("Invalid attribute binding syntax");if("-"!==t[7]&&"0"!==t[7]||(e=!0,t=t.slice(0,7)+t.slice(8)),t.length<9)throw new Error("Binding attribute name is missing.");return{type:e?"boolNegative":"bool",detail:t.slice(8)}}if(t.startsWith("i5_switch")){let e=!1;if(":"!==t[9]&&"_"!==t[9]&&"-"!==t[9]&&"0"!==t[9])throw new Error("Invalid switch binding syntax");if("-"!==t[9]&&"0"!==t[9]||(e=!0,t=t.slice(0,9)+t.slice(10)),t.length<11)throw new Error("Class switch name is missing.");return{type:e?"switchClassNegative":"switchClass",detail:t.slice(10)}}if(t.startsWith("i5_if")){let e=!1;return"-"!==t.slice(-1)&&"0"!==t.slice(-1)||(e=!0),{type:e?"ifNegative":"if"}}return t.startsWith("i5_loop")?"i5_loop:null"===t?{type:"loop",detail:"null"}:{type:"loop"}:t.startsWith("i5_target")?{type:"target"}:t.startsWith("i5_input")?{type:"input",detail:t.endsWith("_value")||t.endsWith(":")?"2way":""}:{type:t.slice(3)}}}r.BoundComponent=BoundComponent;class g extends HTMLElement{constructor(){super()}}r.TemplateReplacementValue=g},{"../Html/CreateElement":8,"../Html/ElementType":10,"../Html/EscapeHtml":11,"../Html/ExtractNodeContent":12,"../Html/FormFieldValue":14,"../Html/QuerySelectorNodeList":15,"../Observable/IObservable":25,"../Observable/ObservableProperty":32,"../Observable/ObservableState":34,"../System/Types/Constructable":47,"../System/Types/KeywordArguments":48,"../System/Types/NoneType":49,"./Component":18,"./ComponentMap":19}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const a=e("../Html/CreateElement"),s=e("../Html/ElementType"),n=e("../Html/FormFieldValue"),i=e("../Html/QuerySelectorNodeList"),o=e("../System/Types/KeywordArguments"),l=e("../System/Utility/GetUniqueId"),c=e("./ComponentMap");r.Component=class{constructor(e){this.content=null,e&&"string"==typeof e?function(e){n.call(this,{outerHtml:e})}.call(this,e):e&&e.selector?(e.innerHtml&&(e.properties=Object.assign(e.properties||{},{innerHTML:e.innerHtml})),function(e){var t=(e.parent||document).querySelector(e.selector);if(!t)throw new Error("Element selector could not find element.");e.element=t,r.call(this,e)}.call(this,e)):e?e.element?(e.innerHtml&&(e.properties=Object.assign(e.properties||{},{innerHTML:e.innerHtml})),r.call(this,e)):(e.outerHtml?n:function(e){var t={innerHTML:e.innerHtml||""};Object.assign(t,e.properties),this.content=a.createElement(e.type||s.elementType.HTMLDivElement,t,e.attributes),e.id?this.content.id=e.id:this.content.id||(this.content.id=l.getUniqueId())}).call(this,e):function(){this.content=a.createElement(s.elementType.HTMLDivElement,{id:l.getUniqueId()})}.call(this),this._checkInlineEventListeners();try{var t="iv_"+this.constructor.name.charAt(0).toLowerCase()+this.constructor.name.slice(1).replace(/\W+/g," ").replace(/([a-z])([A-Z])([a-z])/g,"$1 $2$3").split(/\B(?=[A-Z]{2,})/).join(" ").split(" ").join("_").toLowerCase();this.content.setAttribute(t,"")}catch(e){}function r(e){if(this.content=e.element,e.attributes)for(const t of Object.getOwnPropertyNames(e.attributes))this.content.setAttribute(t,e.attributes[t]);e.properties&&Object.assign(this.content,e.properties)}function n(e){var t=a.div(e.outerHtml.trim());if(1!==t.childNodes.length||!t.firstElementChild)throw new Error("OuterHtml must contain exactly one HTMLElement");if(this.content=t.firstElementChild,e.attributes)for(const r of Object.getOwnPropertyNames(e.attributes))this.content.setAttribute(r,e.attributes[r]);e.properties&&Object.assign(this.content,e.properties),e.id&&(this.content.id=e.id)}this.mapComponent()}static inject(e="[ichigo]",t,r){({selector:e="[ichigo]",options:t,constructor:r}=o.Kwarg.parseArgs({selector:e,options:t,constructor:r}));const n=r||this,s=this._getOptions(t);return this._inject(e,s,e=>this._replaceElementWithComponent(e,s,n),e=>this._convertElementToComponent(e,n))}static _inject(e="[ichigo]",t,r,n){const s=[];var i=this._lookUpContainersToInject(e,t.parent);for(const o of i)t.replace?(1<i.length&&(delete t.id,"properties"in t&&delete t.properties.id,"attributes"in t&&delete t.attributes.id),s.push(r(o))):s.push(n(o));return s}static _mergePropertiesAndAttributes(e,t){const r={innerHTML:e.innerHTML},n={};for(const i of Array.from(e.attributes))n[i.name]=i.value;const s=Object.assign({},t);if(s.outerHtml){t=a.div(s.outerHtml.trim());if(1!==t.childNodes.length||!t.firstElementChild)throw new Error("OuterHtml must contain exactly one HTMLElement");t=t.firstElementChild;delete r.innerHTML;for(const o of Array.from(t.attributes))o.name in n&&delete n[o.name]}return s.properties=Object.assign(r,s.properties),s.attributes=Object.assign(n,s.attributes),s}static _getOptions(e){let t;return t=e&&"string"==typeof e?{replace:!0,outerHtml:e}:e||{replace:!1},t}static _replaceElement(e,t){(e.parentNode||document).replaceChild(t.content,e)}static _replaceElementWithComponent(e,t,r){this._mergePropertiesAndAttributes(e,t);t=new r(t);return this._replaceElement(e,t),t}static _convertElementToComponent(e,t){return new t({element:e})}static _lookUpContainersToInject(e="[ichigo]",t){null===e&&console.warn("Injection selector is null."),e=e||"[ichigo]";let r;return r=t&&"string"==typeof e?(t=t||document,Array.from(t.querySelectorAll(e))):"string"==typeof e?Array.from(document.querySelectorAll(e)):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e],r}get id(){return this.content.id}set id(e){this.content.id=e}get innerHTML(){return this.content.innerHTML}set innerHTML(e){this.content.innerHTML=e}get value(){return n.getFormFieldValue(this.content)}set value(e){n.setFormFieldValue(this.content,e)}get className(){return this.content.className}set className(e){this.content.className=e}get classList(){return this.content.classList}get style(){return this.content.style}addEventListener(e,t,r){return this.content.addEventListener(e,t,r),this}addInlineEventListeners(e){for(const t of i.nodeListSelectorAll([this.content],"[i5_event], [\\00003Aevent], [data-i5_event]"))if(!e||t.getAttribute("component")===e){const r=Array.from(t.attributes);let e=r.find(e=>e.name.startsWith("(")&&e.name.endsWith(")")&&2<e.name.length);if(e=e||r.find(e=>e.name.startsWith("_")&&e.name.endsWith("_")&&2<e.name.length),!e||!e.value)throw new Error(`Event definition not declared for element ${t.id||t.tagName}`);const n=this[e.value];if("function"!=typeof n)throw new Error(`Handler method for element ${t.id||t.tagName} ${e.value} does not exist`);t.addEventListener(e.name.slice(1,-1),n.bind(this))}return this}append(e){var t;return(t=e)&&"content"in t&&t.content instanceof Node?this.content.appendChild(e.content):this.content.appendChild(e),this}appendChild(e){return(t=e)&&"content"in t&&t.content instanceof Node?this.content.appendChild(e.content):this.content.appendChild(e);var t}appendToParent(e){var t;return((t=e)&&"content"in t&&t.content instanceof Node?e.content:e).appendChild(this.content),this}mapComponent(){if(c.getComponent(this.content))throw new Error("Content already referenced by a component");return c.ComponentMap.components.set(this.content,this),this}unmapComponent(){return c.ComponentMap.components.delete(this.content),this}*getAllChildComponents(){for(const t of this.content.querySelectorAll("*")){var e=c.getComponent(t);e&&(yield e)}}setStyle(e,t){if("string"==typeof e&&t)this.content.style.setProperty(e,t);else for(const n of Object.getOwnPropertyNames(e)){var r=e[n];this.content.style.setProperty(n,r)}return this}addClass(e){if(!e)return this;"string"==typeof e&&e.includes(" ")?e=e.split(" ").filter(e=>""!==e):"string"==typeof e&&(e=[e]);for(const t of e)this.content.classList.add(t);return this}_checkInlineEventListeners(){for(const e of i.nodeListSelectorAll([this.content],"[i5_event], [\\00003Aevent], [data-i5_event]"))window.__event_warning__||(console.info("Inline event listeners are configured. Remember to call addInlineEventListeners()."),window.__event_warning__=!0),setTimeout(()=>delete window.__event_warning__,1e3)}}},{"../Html/CreateElement":8,"../Html/ElementType":10,"../Html/FormFieldValue":14,"../Html/QuerySelectorNodeList":15,"../System/Types/KeywordArguments":48,"../System/Utility/GetUniqueId":54,"./ComponentMap":19}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});class n{}n.components=new WeakMap,r.ComponentMap=n,r.getComponent=function(e){return"string"!=typeof e||(e=document.getElementById(e))?n.components.get(e):void 0}},{}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});class n{constructor(e){Object.assign(this,e)}}(class extends(r.ComponentBindingOptions=n){});r.ExistingElementBindingOptions=class extends n{constructor(e){super(e),Object.assign(this,e),this.element=e.element}};r.ExistingLookupBindingOptions=class extends n{constructor(e){super(e),Object.assign(this,e),this.selector=e.selector}};r.InnerHtmlBindingOptions=class extends n{constructor(e){super(e),Object.assign(this,e)}};r.OuterHtmlBindingOptions=class extends n{constructor(e){super(e),Object.assign(this,e),this.outerHtml=e.outerHtml}}},{}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ExistingElementOptions=class{constructor(e){Object.assign(this,e),this.element=e.element}}},{}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ExistingLookupOptions=class{constructor(e){Object.assign(this,e),this.selector=e.selector}}},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.InnerHtmlOptions=class{constructor(e){Object.assign(this,e)}}},{}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.OuterHtmlOptions=class{constructor(e){Object.assign(this,e),this.outerHtml=e.outerHtml}}},{}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../System/EventHandler/EventHandler");r.observableCheck=function(e){return e&&"object"==typeof e&&"changeHandler"in e&&e.changeHandler instanceof n.EventHandler}},{"../System/EventHandler/EventHandler":45}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("../../System/EventHandler/ArrayChangedEventArgs"),n=e("../../System/Utility/ObjectFullAssign");class s extends e("../ObservableBase").ObservableBase{constructor(e){super({name:"ArrayProxy",disableAsync:e})}}class i extends Array{constructor(...e){super(...e)}static getMergedObservable(e,t){e=new i(...e),t=n.objectFullAssign(e,new s(t));return Object.defineProperty(t,"changeHandler",{enumerable:!1}),t}static get[Symbol.species](){return Array}publishCollectionChanged(e,t,r,n,s,i){this.changeHandler.invoke(new o.ArrayChangedEventArgs({type:e,propertyName:t,args:r,oldValue:n,newValue:s,sender:i}))}toJSON(){return this.slice()}}r.ArrayObservable=i},{"../../System/EventHandler/ArrayChangedEventArgs":43,"../../System/Utility/ObjectFullAssign":57,"../ObservableBase":31}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("../../System/Utility/IsInteger");class n{get(s,i,o){if(i in s){const a=Reflect.get(s,i,o);return-1===n.methodsToWatch.indexOf(i.toString())?a:(...e)=>{var t=s.slice(),r=a.apply(s,e),n=s.slice();return s.publishCollectionChanged("call",i,e,t,n,o),r}}}set(e,t,r,n){if(!t||"length"!==t.toString()&&"number"!=typeof t&&!o.isPositiveIntegerString(t))return Reflect.set(e,t,r,n),!0;var s=e.slice();Reflect.set(e,t,r,n);var i=e.slice();return e.publishCollectionChanged("set",t,[r],s,i,n),!0}deleteProperty(e,t){var r=e.slice();Reflect.deleteProperty(e,t);var n=e.slice();return e.publishCollectionChanged("delete",t,[],r,n,null),!0}}n.methodsToWatch=["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"],r.ArrayProxyHandler=n},{"../../System/Utility/IsInteger":55}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const i=e("../../System/EventHandler/PropertyChangedEventArgs");var n=e("../ObservableBase");const s=e("../../System/Utility/ObjectFullAssign");class o extends n.ObservableBase{static getMergedObservable(e,t){t=s.objectFullAssign(e,new o(t),!0);return Object.defineProperty(t,"changeHandler",{enumerable:!1}),t}constructor(e){super({name:"ObjectProxy",disableAsync:e})}publishPropertyChanged(e,t,r,n,s){this.changeHandler.invoke(new i.PropertyChangedEventArgs({type:e,propertyName:t,oldValue:r,newValue:n,sender:s}))}toJSON(){return super.toJSON()}}r.ObjectObservable=o},{"../../System/EventHandler/PropertyChangedEventArgs":46,"../../System/Utility/ObjectFullAssign":57,"../ObservableBase":31}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ObjectProxyHandler=class{constructor(e,t,r,n){this._methodsToWatch=e,this._watchSet=t,this._watchDelete=r,this._triggerOnlyOnChange=n}get(r,n,s){if(n in r){const i=Reflect.get(r,n,s);return-1===this._methodsToWatch.indexOf(n.toString())||"function"!=typeof i?i:(...e)=>{var t=i.apply(r,e);return r.publishPropertyChanged("call",n,void 0,e,s),t}}}set(e,t,r,n){if(this._watchSet){var s=Reflect.get(e,t,n);return(Reflect.set(e,t,r,n),this._triggerOnlyOnChange&&s===r)?!0:(e.publishPropertyChanged("set",t,s,r,n),!0)}return Reflect.set(e,t,r,n),!0}deleteProperty(e,t){if(this._watchDelete){var r=Reflect.get(e,t);return Reflect.deleteProperty(e,t),e.publishPropertyChanged("delete",t,r,void 0,null),!0}return Reflect.deleteProperty(e,t),!0}}},{}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("./ObservableProperty");r.observableAssign=function(t,...e){t=t||{};for(const n of e)for(const s of Object.getOwnPropertyNames(n)){var r=n[s];const i=t[s];let e;e=o.observablePropertyCheck(r)?r.value:r,o.observablePropertyCheck(i)?i.value=e:t[s]=e}}},{"./ObservableProperty":32}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const i=e("../System/EventHandler/EventHandler");r.ObservableBase=class{constructor({name:e,forwardTo:t,bubbleFrom:r,disableAsync:n}={}){if(this.changeHandler=new i.EventHandler,n&&(this.changeHandler=new i.EventHandler(!0)),t&&this.sendChangeEventsTo(t),r)for(const s of r)this.receiveChangeEventsFrom(s);this.tagDelegate(e)}subscribe(e,t){return this.changeHandler.subscribe(e,t)}sendChangeEventsTo(e){this.subscribe(e.changeHandler.delegate)}receiveChangeEventsFrom(e){e.subscribe(this.changeHandler.delegate)}unsubscribeCallback(e){return this.changeHandler.unsubscribeCallback(e)}unsubscribeSender(e){return this.changeHandler.unsubscribeListener(e)}unsubscribeDelegate(e){return this.changeHandler.unsubscribeDelegate(e)}tagDelegate(e){e&&(this.changeHandler.delegate._tag=e)}dispose(){this.changeHandler.dispose()}toJSON(){const e={};for(const t in this)"changeHandler"!==t&&"privateProperty2"!==t&&(e[t]=this[t]);return e}}},{"../System/EventHandler/EventHandler":45}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../Html/EscapeHtml"),i=e("../System/EventHandler/PropertyChangedEventArgs"),s=e("../System/Types/NoneType"),o=e("../System/Utility/IsPrimitive"),a=e("./IObservable");class l extends e("./ObservableBase").ObservableBase{constructor(e,t={}){super(t),this.propertyName="",this._triggerOnlyOnChange=!1,t=t||{},this._value=e,this.propertyName=t.name||"",this._triggerOnlyOnChange=t.onlyWhenChanged||!1}get value(){return this._value}set value(e){var t=this._value;this._value=e,this._triggerOnlyOnChange&&t===e||this.publishPropertyChanged("set",this.propertyName,t,e,this)}get safeValue(){return s.isNone(this._value)||!o.isPrimitive(this._value)?"":n.escapeHtml(String(this._value))}toString(){return JSON.stringify(this._value)}toJSON(){return this._value}publishPropertyChanged(e,t,r,n,s){this.changeHandler.invoke(new i.PropertyChangedEventArgs({type:e,propertyName:t,oldValue:r,newValue:n,sender:s}))}}r.ObservableProperty=l,r.observablePropertyCheck=function(e){return!!a.observableCheck(e)&&(e&&e instanceof l)}},{"../Html/EscapeHtml":11,"../System/EventHandler/PropertyChangedEventArgs":46,"../System/Types/NoneType":49,"../System/Utility/IsPrimitive":56,"./IObservable":25,"./ObservableBase":31}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("./Internal/ArrayObservable"),s=e("./Internal/ArrayProxyHandler"),o=e("./Internal/ObjectObservable"),a=e("./Internal/ObjectProxyHandler");class l{static proximate(e,t,r){if("function"==typeof e)throw new Error("Unsupported type: function");return Array.isArray(e)?this.proximateArray(e,t,r):"object"==typeof e?this.proximateObject(e,t,r):this.proximateObject({value:e},t,r)}static proximateObject(e,t,r,n=[],s=!0,i=!0){if("function"==typeof e)throw new Error("Unsupported type: function");t=o.ObjectObservable.getMergedObservable(e,t),r=new a.ObjectProxyHandler(n||[],s||!1,i||!1,r||!1),r=new Proxy(t,r);return l._models.set(r,t),r}static proximateArray(e,t,r){e=n.ArrayObservable.getMergedObservable(e,t),t=new s.ArrayProxyHandler,t=new Proxy(e,t);return l._models.set(t,e),t}}l._models=new WeakMap,r.ObservableProxy=l},{"./Internal/ArrayObservable":26,"./Internal/ArrayProxyHandler":27,"./Internal/ObjectObservable":28,"./Internal/ObjectProxyHandler":29}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../Html/EscapeHtml"),i=e("../System/EventHandler/PropertyChangedEventArgs"),s=e("../System/Types/NoneType"),o=e("../System/Utility/CloneDeep"),a=e("../System/Utility/IsPrimitive"),l=e("./IObservable");class c extends e("./ObservableBase").ObservableBase{constructor(e,t={}){super(t),this.propertyName="",e instanceof c?this._value=o.cloneDeep(e.value):this._value=o.cloneDeep(e),this.propertyName=(t=t||{}).name||"setState"}get value(){return o.cloneDeep(this._value)}set value(e){this.setState(e,!0)}getSafeValue(e){if(!e)return!s.isNone(this._value)&&a.isPrimitive(this._value)?n.escapeHtml(String(this._value)):"";e=this.value[e];return s.isNone(e)||!a.isPrimitive(e)?"":n.escapeHtml(String(e))}getValue(e){return e?this.value[e]:!s.isNone(this._value)&&a.isPrimitive(this._value)?o.cloneDeep(this._value):void 0}getState(){return this.value}setState(e,t=!1){var r=o.cloneDeep(this._value);let n,s;if(a.isPrimitive(this._value)){if("function"==typeof e)throw new Error("Cannot call setState with a function if state is primitive.");t=!0}if(t)n=function(e){return this._value=o.cloneDeep(e),e}.call(this,e);else if("function"==typeof e)[n,s]=function(e){var t=o.cloneDeep(this._value),e=e.call(t,t);return this._value=o.cloneDeep(t),[t,e]}.call(this,e);else{if(!e||"object"!=typeof e)throw new Error("value is not a partial state or a function");n=function(e){const t=o.cloneDeep(this._value);for(const r of Object.getOwnPropertyNames(e))t[r]=e[r];return this._value=o.cloneDeep(t),t}.call(this,e)}return this.publishPropertyChanged("call",this.propertyName,r,n,this),{oldValue:r,newValue:n,returnValue:s}}toString(){return JSON.stringify(this._value)}toJSON(){return this.value}publishPropertyChanged(e,t,r,n,s){this.changeHandler.invoke(new i.PropertyChangedEventArgs({type:e,propertyName:t,oldValue:r,newValue:n,sender:s}))}}r.ObservableState=c,r.observableStateCheck=function(e){return!!l.observableCheck(e)&&(e&&e instanceof c)}},{"../Html/EscapeHtml":11,"../System/EventHandler/PropertyChangedEventArgs":46,"../System/Types/NoneType":49,"../System/Utility/CloneDeep":51,"../System/Utility/IsPrimitive":56,"./IObservable":25,"./ObservableBase":31}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const a=e("../Html/CreateElement"),n=e("../Html/DeleteNodeContent"),s=e("../Html/ElementType"),l=e("../System/Collections/ArrayUtilities"),i=e("../System/Types/Constructable"),c=e("../System/Utility/Elvis");class o{static get matchedRoute(){return this._matchedRoute||{route:"",params:new Map}}static get params(){return this.matchedRoute.params}static get historyMaxLength(){return this._historyMaxLength}static set historyMaxLength(e){this._history.length>e&&(this._history.length=e),this._historyMaxLength=e}static get history(){return this._history}static set notFound(e){this._notFound=e}static configure(e){this._routes=e}static addAppRoute(e,t="*",r=!0){r&&this.turnOnUrlRouting(),i.constructorTypeGuard(e)||"function"==typeof e?this.addRoute({route:t,payload:e,routeContainer:"page-router",staticRouterContainer:!0}):this.addRoute({route:t,payload:()=>e,routeContainer:"page-router",staticRouterContainer:!0})}static addRoute(t){if(this._routes.find(e=>e.route===t.route&&(e.routeContainer||"child-container")===(t.routeContainer||"child-container")))throw new Error("Route and container already exists.");this._routes.push(t)}static deleteRoute(t){if(!this._routes.find(e=>e.route===t))throw new Error("Route not found.");const r=this._routes;for(let e=0;e<r.length;e++)r[e].route!==t||r.splice(e,1)}static route(e,t=!0){if(e)t&&(window.location.hash=e),this._lastRoute=e;else if((e=window.location.hash.slice(1))===this._lastRoute)return void(this._lastRoute=void 0);var r=this._routes.slice(0).map(e=>({route:e}));const n=[],s=[];for(const d of r){var i=this._searchRoutes(e,d.route,r);i&&(s.push(i),n.push(d))}if(!n.length)return console.log(`Route ${e} not found.`),void this._renderNotFound();const o=new Map;for(const p of s)for(const m of p.entries())o.has(m[0])||o.set(m[0],m[1]);this._matchedRoute={route:e,params:o},0!==this.history.length&&this.history[this.history.length-1]===e||this._history.push(e),this.history.length>this.historyMaxLength&&this._history.shift();const a=this._routeContainers.slice(0);for(const f of a.filter(t=>!n.find(e=>e.route===t.route)||!t.route.staticRouterContainer)){f.container&&f.container.remove();var l=a.findIndex(e=>e===f);a.splice(l,1)}a.push(...n.filter(t=>!a.find(e=>e.route===t.route)));const c=a.slice(0),u=[];for(const y of n){var h=c.find(e=>e.route===y.route);if(!h)throw new Error("How did a route not get added to routeContainers?");u.push(h)}this._routeContainers=u;for(const g of n){let e=[];Array.isArray(g.route.routeGuards)?e=g.route.routeGuards:g.route.routeGuards&&e.push(g.route.routeGuards);for(const b of e)!1!==b.checkValid(g.route)||console.warn("Route permission denied");this._renderRoute(g)}}static back(){var e;this.history.length<2||(this._history.pop(),void 0!==(e=this._history.pop())&&this.route(e))}static turnOnUrlRouting(){this._hashChange=e=>{this.route()},window.addEventListener("hashchange",this._hashChange)}static _searchRoutes(e,t,r){let n=[];n=Array.isArray(t.route)?t.route:[t.route];for(const i of n){var s=this._testRoute(i,e||"");if(s){if(t.children)for(const o of t.children)r.push({route:o,parent:t});return s}}return!1}static _testRoute(e,t){const r=new Map;if(!e||!t)return!1;(e=e.toLowerCase()).endsWith("/")&&(e=e.slice(0,-1)),t.endsWith("/")&&(t=t.slice(0,-1));const n=e.split("/"),s=t.split("/");if("*"===n[n.length-1]&&(n.length--,n.length<=s.length&&(s.length=n.length)),n.length!==s.length)return!1;for(var[i,o]of l.zip(n,s))if(i.startsWith(":")){if(r.has(o.slice(1)))throw new Error(`Route ${e} contains duplicates of the same parameter.`);r.set(i.slice(1),o)}else if("*"!==i&&i!==o.toLowerCase())return!1;return r}static _renderRoute({route:t,parent:e}){const r=this._prepareRouterContainer(t,e);if(r){let e;i.constructorTypeGuard(t.payload)?e=new t.payload:t.payload&&(e=t.payload()),e&&function(e){if("content"in e&&e.content instanceof HTMLElement)return!0;return!1}(e)?r.appendChild(e.content):e&&r.appendChild(e)}}static _renderNotFound(){const e=a.createElement("not-found",{id:"not-found"});n.deleteNodeContent(document.body),document.body.appendChild(e),e.appendChild(a.createElement(s.elementType.HTMLDivElement,{innerHTML:this._notFound||"Quoth the Raven, 404"}))}static _prepareRouterContainer(t,r){if(!this._matchedRoute)throw new Error("ProgrammingError: _prepareRouterContainer called out of order.");const e=this._routeContainers.find(e=>e.route===t);if(!e)throw new Error("ProgrammingError: Forgot to add routes to route containers.");let n;if(n=c.e_(this._routeContainers.find(e=>e.route===r)).container,n&&!document.body.contains(n)&&(n=void 0),!(t.staticRouterContainer&&e.container&&(n||document.body).contains(e.container))){const i=c.e_(t).routeContainer||"child-container";n&&document.body.contains(n)||(document.body||document.createElement("body"),n=document.body);var s=this._routeContainers.findIndex(e=>e.route===t);if(!this._routeContainers.slice(0,s).find(e=>!!e.container&&e.container.tagName.toLowerCase()===i.toLowerCase()&&!!n.querySelector(i))){s=a.createElement(i);const o=n.querySelector(i);return o?(o.parentElement||n).replaceChild(s,o):n.appendChild(s),e.container=s}console.log(`Route: [${t.route}]. Container [${i}] added to DOM by another route. Skipping.`)}}}o._routes=[],o._history=[],o._historyMaxLength=50,o._routeContainers=[],r.AdvancedPageRouter=o},{"../Html/CreateElement":8,"../Html/DeleteNodeContent":9,"../Html/ElementType":10,"../System/Collections/ArrayUtilities":41,"../System/Types/Constructable":47,"../System/Utility/Elvis":53}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../Html/CreateElement"),i=e("../Html/DeleteNodeContent"),s=e("../Html/ElementType"),a=e("../System/Collections/ArrayUtilities"),o=e("../System/Types/Constructable"),l=e("../System/Types/KeywordArguments"),c=e("../System/Types/NoneType");class u{static get allRoutes(){return this._routes}static get matchedRoute(){return this._matchedRoute||{route:"",params:new Map,config:{route:""}}}static get params(){return this.matchedRoute.params}static get historyMaxLength(){return this._historyMaxLength}static set historyMaxLength(e){this._history.length>e&&(this._history.length=e),this._historyMaxLength=e}static get history(){return this._history}static set notFound(e){this._notFound=e}static configure(e=[],t,r,n,s,i=!0){({routes:e,defaultLayout:t,defaultStaticLayout:r,notFound:n,defaultRoute:s,urlRoutingEnabled:i=!0}=l.Kwarg.parseArgs({routes:e,defaultLayout:t,defaultStaticLayout:r,notFound:n,defaultRoute:s,urlRoutingEnabled:i})),this._configured=!0,n&&(this._notFound=n);for(const o of e)t&&(o.layout=o.layout||t),!c.isNone(r)&&c.isNone(o.staticLayout)&&(o.staticLayout=r),this.addRoute(o);i&&this.turnOnUrlRouting(),this.routeContainer=document.querySelector("page-router")||document.body;try{window.customElements.get("page-router")||window.customElements.define("page-router",h,{extends:"div"}),window.customElements.get("layout-body")||window.customElements.define("layout-body",d,{extends:"div"}),window.customElements.get("not-found")||window.customElements.define("not-found",p,{extends:"div"})}catch(e){}s&&this.defaultRoute(s)}static addRoute(e){let t;t=Array.isArray(e.route)?e.route:[e.route];for(const r of t){if(this._routes.find(e=>e.route===r))throw new Error("Route already exists.");const n=Object.assign({},e);n.route=r,this._routes.push(n)}}static defaultRoute(e){window.location.hash?u.route():u.route(e)}static route(e,t=!0){if(!this._configured)throw new Error("PageRouter not configured. Call configure() first.");if(e)t&&(window.location.hash=e),this._lastRoute=e;else if((e=window.location.hash.slice(1))===this._lastRoute)return void(this._lastRoute=void 0);let r,n=!1;for(const i of this._routes)if(n=this._testRoute(i.route,e||""),n){r=i;break}if(!r)return console.log(`Route ${e} not found.`),void this._renderNotFound();t=(this._matchedRoute||{}).config;this._matchedRoute={route:e,params:n||new Map,config:r},0!==this.history.length&&this.history[this.history.length-1]===e||this._history.push(e),this.history.length>this.historyMaxLength&&this._history.shift();let s=[];Array.isArray(r.routeGuards)?s=r.routeGuards:r.routeGuards&&s.push(r.routeGuards);for(const o of s)if(!1===o.checkValid(r))return void console.warn("Route permission denied");this._renderRoute(r,t)}static back(){var e;this.history.length<2||(this._history.pop(),void 0!==(e=this._history.pop())&&this.route(e))}static turnOnUrlRouting(){this._hashChange=e=>{this.route()},window.addEventListener("hashchange",this._hashChange)}static _testRoute(t,e){const r=new Map;if(!t||!e)return!1;(t=t.toLowerCase()).endsWith("/")&&(t=t.slice(0,-1)),e.endsWith("/")&&(e=e.slice(0,-1));var n,s,i=t.split("/"),e=e.split("/");if(i.length!==e.length)return!1;for([n,s]of a.zip(i,e))if(n.startsWith(":")){let e=n.slice(1);if(e.includes("=")){var o=e.split("=")[1];if(e=e.split("=")[0],o!==s)return!1;if(r.has(e))throw new Error(`Route ${t} contains duplicates of the same parameter.`);r.set(e,s)}else{if(r.has(e))throw new Error(`Route ${t} contains duplicates of the same parameter.`);r.set(e,s)}}else if(n!==s.toLowerCase())return!1;return r}static _renderRoute(t,e){let r=this.routeContainer;e=t.layout&&e&&t.staticLayout&&t.layout===e.layout;if(e||i.deleteNodeContent(r),e){if(r=document.querySelector("layout-body"),!r)throw new Error("<layout-body> element not found")}else if(t.layout){let e;if(o.constructorTypeGuard(t.layout)?e=new t.layout:t.payload&&(e=t.layout()),e&&s(e)?r.appendChild(e.content):e&&r.appendChild(e),r=document.querySelector("layout-body"),!r)throw new Error("<layout-body> element not found")}e&&i.deleteNodeContent(r);let n;function s(e){return"content"in e&&e.content instanceof HTMLElement}o.constructorTypeGuard(t.payload)?n=new t.payload:"function"==typeof t.payload?n=t.payload():t.payload&&(n=t.payload.cloneNode(!0)),n&&s(n)?r.appendChild(n.content):n&&r.appendChild(n)}static _renderNotFound(){i.deleteNodeContent(this.routeContainer),this.routeContainer.appendChild(n.createElement(s.elementType.HTMLDivElement,{id:"not-found",innerHTML:this._notFound||"Quoth the Raven, 404"}))}}u.routeContainer=document.body,u._configured=!1,u._routes=[],u._history=[],u._historyMaxLength=50,r.PageRouter=u;class h extends HTMLElement{constructor(){super()}}class d extends HTMLElement{constructor(){super()}}class p extends HTMLElement{constructor(){super()}}},{"../Html/CreateElement":8,"../Html/DeleteNodeContent":9,"../Html/ElementType":10,"../System/Collections/ArrayUtilities":41,"../System/Types/Constructable":47,"../System/Types/KeywordArguments":48,"../System/Types/NoneType":49}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.DeferredPromise=class{constructor(e,t=!1){this.throwOnUnhandledError=t,this.resolve=function(){},this.reject=function(){},this._promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),e?this.then(e,t):this.then(e=>e,t)}get output(){return this._promise}then(e,t=this.throwOnUnhandledError){return e&&(this._promise=this._promise.then(e)),t&&(this._promise=this._promise.catch(e=>{throw e})),this}catch(e,t=this.throwOnUnhandledError){return e&&(this._promise=this._promise.catch(e)),t&&(this._promise=this._promise.catch(e=>{throw e})),this}}},{}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.delay=function(r){return t=>new Promise(e=>setTimeout(()=>e(t),r))}},{}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const DeferredPromise_1=require("./DeferredPromise");class DynamicWebWorker{constructor(){function setupFunc(){const ctx=self;ctx.onmessage=function(evt){const{id,fn,args}=evt.data;try{let inputFunc;eval("inputFunc = "+fn+";");const argarray=JSON.parse(args)||[],result=inputFunc(...argarray);ctx.postMessage({id:id,result:JSON.stringify(result)})}catch(err){ctx.postMessage({id:id,error:err})}}}this.deferredId=0,this.deferreds=new Map,this._setUpWorker(setupFunc)}taskStart(e,...t){var r=this.deferredId++,t={id:r,fn:e.toString(),args:JSON.stringify(t)};const n=new DeferredPromise_1.DeferredPromise;return this.deferreds.set(r,n),this.worker.postMessage(t),n.output.then(e=>JSON.parse(e||"")).catch(e=>{throw e||new Error("Unknown error")})}_setUpWorker(e){this.worker=new Worker(URL.createObjectURL(new Blob(["("+e.toString()+")();"]))),this.worker.onmessage=e=>{var{id:t,result:r,error:e}=e.data;const n=this.deferreds.get(t);if(!n)throw new Error("Deferred promise is missing.");e?n.reject(e):n.resolve(r),this.deferreds.delete(t)}}}exports.DynamicWebWorker=DynamicWebWorker},{"./DeferredPromise":37}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("./DeferredPromise");r.RepeatablePromise=class{constructor(e,t,r=!1){this.onUnhandledError=t,this.throwOnUnhandledError=r,this.callbacks=[],e?this.then(e):this.then(e=>e)}resolve(e){const t=this.build();return t.resolve(e),t.output}reject(e){const t=this.build();return t.reject(e),t.output}then(e){return this.callbacks.push({onfulfilled:e}),this}catch(e){return this.callbacks.push({onrejected:e}),this}build(){let e;for(const t of this.callbacks)if(e)t.onfulfilled?e.then(t.onfulfilled):t.onrejected&&e.catch(t.onrejected);else{if(!t.onfulfilled)throw new Error("Bug in RepeatablePromise constructor. First onfulfilled is null.");e=new n.DeferredPromise(t.onfulfilled,!1)}if(!e)throw new Error("Bug in RepeatablePromise constructor. No callbacks, not even the default first onfulfilled.");return this.onUnhandledError&&e.catch(this.onUnhandledError),this.throwOnUnhandledError&&e.catch(e=>{throw e}),e}}},{"./DeferredPromise":37}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.zip=function(r,n){return r.length>=n.length?r.map((e,t)=>[e,n[t]]):n.map((e,t)=>[r[t],n])},r.cartesian=function(e,t){const r=[];for(const n of e)r.push(...t.map(e=>[n,e]));return r},r.range=function(e){return Array.from({length:e},(e,t)=>t)};r.traverse=function*e(t){if(Array.isArray(t))for(const r of t)yield*e(r);else yield t}},{}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.orderBy=function(r){return function(e,t){e=r(e),t=r(t);return e<t?-1:t<e?1:0}}},{}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ArrayChangedEventArgs=class{constructor(e){this.type="",this.propertyName="",this.args=[],Object.assign(this,e)}}},{}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../Async/RepeatablePromise");r.Delegate=class{constructor(e,t){if(t||console.warn("Delegate created without thisArg. Did you mean to?"),(this.thisArg=t)&&"object"==typeof t&&"constructor"in t&&(this.callbackOwnerName=t.constructor.name),!e)throw new Error("callback is required");if("function"!=typeof e)throw new Error("callback must be a callback function");this.callback=e,this.callbackName=e.name,this.callbackOwnerName&&this.callbackName?this.name=`${this.callbackOwnerName}.${this.callbackName}()`:this.callbackName?this.name=this.callbackName+"()":this.callbackOwnerName&&(this.name=this.callbackOwnerName+".__lambda__()"),this.promise=new n.RepeatablePromise(e.bind(t))}}},{"../Async/RepeatablePromise":40}],45:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const i=e("../Collections/ArrayUtilities"),n=e("./Delegate");r.EventHandler=class{constructor(e=!1){this._disableAsync=e,this.delegate=[]}subscribe(e,t){if(Array.isArray(e))(function(t){this.delegate.find(e=>e===t)||this.delegate.push(t)}).call(this,e);else if(!this.find({callback:e,thisArg:t,firstMatch:!0}).length){t=new n.Delegate(e,t);return this.delegate.push(t),this._disableAsync?void 0:t.promise}}unsubscribeCallback(t){var e=this.delegate.findIndex(e=>!Array.isArray(e)&&e.callback===t);0<=e&&this.delegate.splice(e,1)}unsubscribeListener(t){"delegate"in t&&this.unsubscribeDelegate(t.delegate);let e=0;for(;0<=e;)e=this.delegate.findIndex(e=>!Array.isArray(e)&&e.thisArg===t),0<=e&&this.delegate.splice(e,1)}unsubscribeDelegate(t){let e=0;for(;0<=e;)e=this.delegate.findIndex(e=>e===t),0<=e&&this.delegate.splice(e,1)}invoke(e){for(const t of i.traverse(this.delegate))this._disableAsync?t.callback.call(t.thisArg,e):t.promise.resolve(e)}find({callback:t,thisArg:r,firstMatch:e}={}){const n=[];for(const s of i.traverse(this.delegate))if(function(e){if(t&&r)return e.callback===t&&e.thisArg===r;if(t)return e.callback===t;if(r)return e.thisArg===r;return!0}(s)&&(n.push(s),e))break;return n}clear(){this.delegate.length=0}dispose(){this.clear(),this.delegate=void 0}}},{"../Collections/ArrayUtilities":41,"./Delegate":44}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.PropertyChangedEventArgs=class{constructor(e){this.type="",Object.assign(this,e)}}},{}],47:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.constructorTypeGuard=function(e){return e&&e.prototype&&e.prototype.constructor.name}},{}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const h=e("../Utility/IsInteger");class d{constructor(e,t){if(!e)throw new Error("Argument null exception");this.name=e,this.value=t}static parseArgs(e,t=!1){const r={};var n=Object.getOwnPropertyNames(e);for(const l of n)e[l]instanceof d?r[l]=void 0:r[l]=e[l];const s={};r.$$kw$$=s;const i=[];r.$rest$=i;for(const c of Object.getOwnPropertyNames(e).filter(e=>h.isPositiveIntegerString(e)))e[c]instanceof d||i.push(e[c]);const o={};for(const u of n)if(e[u]instanceof d){var a=e[u];if(a.name in r)r[a.name]=a.value;else{if(!t)throw new Error(`Got an unexpected keyword argument '${a.name}'`);s[a.name]=a.value}if(a.name in o)throw new Error(`Got multiple values for keyword argument + '${a.name}'`);o[a.name]=!0}return r}static unpack(e){const t=[];for(const r of Object.getOwnPropertyNames(e))t.push(n(r,e[r]));return t}isMatch(e){return this.name===e}}function n(e,t){if(!e)throw new Error("Argument null exception");if("string"==typeof e)return new d(e,t);if(Array.isArray(e))return new d(e[0],e[1]);t=Object.getOwnPropertyNames(e);if(!t.length)throw new Error("Argument null exception");if(1<t.length)throw new Error("Invalid map object: multiple keys");return new d(t[0],e[t[0]])}r.Kwarg=d,r.kw=n,r.kwargsToObject=function(e){const t={};for(const r of e)t[r.name]=t[r.value];return t}},{"../Utility/IsInteger":55}],49:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isNone=function(e){return null==e||void 0===e}},{}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.assert=function(e,t){if(!e)throw new Error(t||"Failed")}},{}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cloneDeep=function r(e,n=new WeakMap){if(Object(e)!==e)return e;if(n.has(e))return n.get(e);let s;e instanceof Set?(s=new Set,Array.from(e,e=>s.add(r(e,n)))):e instanceof Map?(s=new Map,Array.from(e,([e,t])=>s.add(r(e,n),r(t,n)))):s=Array.isArray(e)?Array.from(e):e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):"function"==typeof e?new Function("return "+e.toString())():Object.getPrototypeOf(e)?Object.create(Object.getPrototypeOf(e)):Object.create(null),n.set(e,s);for(const i of Object.getOwnPropertyNames(e)){var t=Object.getOwnPropertyDescriptor(e,i);t&&!1===t.writable||("function"!=typeof e[i]||i in s?t&&(t.get||t.set)?Object.defineProperty(s,i,t):s[i]=r(e[i],n):t&&(Object.defineProperty(s,i,t),n.set(e[i],s[i])))}return s}},{}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cloneObject=function(e){if(e&&"object"==typeof e){var t=Object.create(Object.getPrototypeOf(e));for(const n of Object.getOwnPropertyNames(e)){var r=Object.getOwnPropertyDescriptor(e,n);r&&Object.defineProperty(t,n,r)}return t}}},{}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../Types/NoneType");r.e_=function(e){return n.isNone(e)?{}:e}},{"../Types/NoneType":49}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("../Collections/ArrayUtilities");r.getUniqueId=function(){var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_";let t="u"+String((new Date).getTime())+"-";for(const r of n.range(8))t+=e.charAt(Math.floor(Math.random()*e.length));return t}},{"../Collections/ArrayUtilities":41}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isPositiveIntegerString=function(e){return!(!e||"string"!=typeof e)&&("0"===e||/^[1-9]\d*$/.test(e))}},{}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isPrimitive=function(e){return Object(e)!==e}},{}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const i=e("./CloneObject"),o=e("../Types/NoneType");r.objectFullAssign=function(e,t,r=!1){if(o.isNone(e)&&(e={}),!t||"object"!=typeof t||"object"!=typeof e)return e;r&&(e=i.cloneObject(e));for(const s of Array.from(new Set(function e(t){const r=[];r.push(...Object.getOwnPropertyNames(t).filter(e=>"constructor"!==e));var t=Object.getPrototypeOf(t);t&&"Object"!==t.constructor.name&&r.push(...e(t));return r}(t)))){var n=function e(t,r){var n=Object.getOwnPropertyDescriptor(t,r);if(n)return n;var t=Object.getPrototypeOf(t);if(t&&"Object"!==t.constructor.name)return e(t,r)}(t,s);n&&Object.defineProperty(e,s,n)}return e}},{"../Types/NoneType":49,"./CloneObject":52}]},{},[1]);